
First me check the whole table:

```
SELECT *
FROM marketing_data
```
### Nulls:
```
SELECT 
  Education, 
  Income 
FROM 
  marketing_data 
WHERE 
  Income IS NULL; -- 24 NULL records on [Income]
```
![dqwqwddwqdwq](https://github.com/mfernandezcean/Marketing_Campaign_Results/assets/105746149/7dfc49f8-0b01-49c9-b336-f3d6abea2558)




Using **Union** to check for other Null Values: 
```


SELECT 
  ID AS TableName, 
  * 
FROM 
  marketing_data 
WHERE 
  ID IS NULL 
UNION ALL 
SELECT 
  Income AS TableName, 
  * 
FROM 
  marketing_data 
WHERE 
  Income IS NULL 
UNION 
SELECT 
  [Marital_Status] AS TableName, 
  * 
FROM 
  marketing_data 
WHERE 
  [Marital_Status] IS NULL 
UNION 
SELECT 
  [Country] AS TableName, 
  * 
FROM 
  marketing_data 
WHERE 
  [Country] IS NULL

```
- After Checking the Table, the NULL values we've got are **only** the 24 rows of [Income]
- We calculate the average income per [Education] category, with the goal of replacing the NULL values.
```
SELECT 
[Education],
AVG(INCOME) AS avg_income
FROM marketing_data
GROUP BY [Education] 
```
![dwqdwqdwqwdq](https://github.com/mfernandezcean/Marketing_Campaign_Results/assets/105746149/603f6ad1-b0ca-49ef-953f-337ce9fab21e)

```


WITH cte1 As
(
SELECT 
	ID,
    Education,
    CASE 
        WHEN Education = 'Graduation' AND Income IS NULL THEN 52720 
        WHEN Education = 'PhD' AND Income IS NULL THEN 56145
		WHEN Education = 'Master' AND Income IS NULL THEN 52917
		WHEN Education = '2n Cycle' AND Income IS NULL THEN 47633
		WHEN Education = 'Basic' AND Income IS NULL THEN 20306  
        ELSE Income 
    END AS INCOME 
FROM marketing_data
WHERE Income IS NULL 
) 
```
![wqddqwdqwwqd](https://github.com/mfernandezcean/Marketing_Campaign_Results/assets/105746149/c30ca979-0f9d-49b7-a778-7721668c7957)

### Outliers
```
SELECT 
ID,
Education,
Marital_Status,
Income,
(Income- AVG(Income) OVER()) / STDEV(Income) OVER() AS zscore 
FROM marketing_data
ORDER BY ID

Select *
FROM
(SELECT 
ID,
Education,
Marital_Status,
Income,
(Income- AVG(Income) OVER()) / STDEV(Income) OVER() AS zscore 
FROM marketing_data
) AS score_table
WHERE zscore > 2.576 or zscore <-2.576  

Select *
FROM
(SELECT 
ID,
Education,
Marital_Status,
Income,
(Income- AVG(Income) OVER()) / STDEV(Income) OVER() AS zscore 
FROM marketing_data
) AS score_table
WHERE zscore > 1.960 or zscore <-1.960  





SELECT Income
FROM marketing_data
WHERE Income IS NOT NULL
AND ABS((Income - (SELECT AVG(Income) FROM marketing_data)) / (SELECT STDEV(Income) FROM marketing_data)) > 5;

SELECT Income
FROM marketing_data
WHERE Income > PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY Income) OVER();

Select *
FROM
(SELECT 
ID,
Year_Birth,
Education,
Marital_Status,
Income,
(Year_Birth- AVG(Year_Birth) OVER()) / STDEV(Year_Birth) OVER() AS zscore 
FROM marketing_data
) AS score_table
WHERE zscore > 2.576 or zscore <-2.576  

```
